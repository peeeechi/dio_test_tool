# DIO Tester Tool

Arduino Dueのデジタル入出力をテストするためのGUIツールです。ROS用のDIOドライバーの実機テストをサポートするために作られました。

## 概要

このツールは以下の機能を提供します：

- Arduino Dueとのシリアル通信を通じたデジタル入出力の監視
- 8チャンネルのデジタル入力(DI)状態の表示
- 8チャンネルのデジタル出力(DO)の制御
- リアルタイムの状態更新

## 必要要件

### ハードウェア
- Arduino Due
- USBケーブル（Arduino Due接続用）

### ソフトウェア
- Python 3.10.12
- TkEasyGUI
- pyserial
- Docker（コンテナ環境で実行する場合）

### Arduinoの設定
- デジタル入力ピン：30-37番（プルアップ抵抗有効）
- デジタル出力ピン：22-29番
- ボーレート：9600bps

## プロジェクト構成

```
.
├── Dockerfile
├── docker-compose.yml
├── requirements.txt
└── src/
    └── main.py
```

## セットアップ方法

### 1. Arduinoの準備
1. Arduino IDEでスケッチを開きます
2. Arduino Dueにスケッチをアップロードします

### 2. アプリケーションの実行（Docker使用）

1. プロジェクトのルートディレクトリで以下のコマンドを実行します：

```bash
docker compose up --build
```

注意：Docker環境では以下の設定が必要です：
- X11のソケットファイルがマウントされていること
- ホストのDISPLAY環境変数が正しく設定されていること
- デバイスファイル（/dev）へのアクセス権限があること

## 使用方法

1. アプリケーションを起動します
2. シリアルポートのドロップダウンメニューから、Arduino Dueが接続されているポートを選択します
3. 「接続」ボタンをクリックしてArduinoと通信を開始します
4. Digital Output (DO) の各ポートは対応するボタンをクリックすることでOn/Offを切り替えられます
5. Digital Input (DI) の状態は自動的に更新され、表示されます

## 通信プロトコル

### コマンドフォーマット
DOの制御コマンド：
```
command-[0,0,0,0,0,0,0,0]-end
```
※ カンマ区切りの8つの値（0または1）

### ステータス応答フォーマット
DIとDOの状態：
```
dio-[DI状態]-[DO状態]-end
```
※ DI状態、DO状態ともにカンマ区切りの8つの値（0または1）

## トラブルシューティング

### Docker環境での表示問題
1. X11の接続エラーが発生する場合：
```bash
xhost +local:docker
```
を実行してX11サーバーへのアクセスを許可してください。

### シリアル通信の問題
1. シリアルポートが表示されない場合：
   - Arduino Dueが正しく接続されているか確認してください
   - Dockerの場合、`docker-compose.yml`の`privileged: true`設定を確認してください
   - デバイスのパーミッションを確認してください

2. 通信エラーが発生する場合：
   - ボーレートが9600に設定されているか確認してください
   - Arduino側のスケッチが正しくアップロードされているか確認してください

## 制限事項

- 現在のバージョンではボーレートは9600固定です
- DIとDOはそれぞれ8チャンネルに固定されています
- GUIの更新レートは100ms間隔です
- 日本語環境での使用を想定しています

## 開発環境のセットアップ

新しい環境でビルド・実行する場合は、以下の手順で環境を準備してください：

1. プロジェクトをクローンまたはダウンロードします
2. 必要なファイルを配置します：
   - `src/main.py`にPythonスクリプトを配置
   - プロジェクトルートに`requirements.txt`を配置
3. Dockerイメージをビルドして実行：
```bash
docker compose up --build
```

## ライセンス

このプロジェクトのライセンス情報を記載してください。